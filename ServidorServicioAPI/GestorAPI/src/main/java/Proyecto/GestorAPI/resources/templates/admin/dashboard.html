<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Panel de Administración</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />
    <style>
        /* Estilos comunes */
        body {
            background-color: #f8f9fa;
        }
        .dashboard-card {
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: none;
        }
        .stat-card {
            transition: transform 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
        }
        .welcome-section {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            border-radius: 10px;
        }
    </style>
</head>
<body class="d-flex flex-column min-vh-100">

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-white bg-white shadow-sm">
    <div class="container-fluid">
        <a class="navbar-brand text-primary fw-bold" th:href="@{/admin/dashboard}">
            <i class="bi bi-boxes me-2"></i>API-GESTHOR
        </a>
        <button
                class="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarNav"
                aria-controls="navbarNav"
                aria-expanded="false"
                aria-label="Toggle navigation"
        >
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" th:href="@{/admin/usuarios}">Usuarios</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/admin/categories}">Categorías</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/admin/expenses}">Gastos</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/admin/tickets}">Tickets</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/admin/subscriptions}">Subscripciones</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/admin/login-attempts}">Log Logins</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/admin/formcontacto}">Form Contacto</a></li>
            </ul>
        </div>
        <button id="logoutButton" class="btn btn-outline-danger ms-auto fw-semibold">
            <i class="bi bi-box-arrow-right me-1"></i>Cerrar sesión
        </button>
    </div>
</nav>

<!-- CONTENIDO PRINCIPAL -->
<div class="container py-4 flex-grow-1">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="fw-bold text-dark">Panel de Administración</h1>
            <p class="text-muted">Resumen general del sistema</p>
        </div>
    </div>

    <!-- Tarjeta de Bienvenida -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card dashboard-card welcome-section">
                <div class="card-body p-4">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h2 class="card-title fw-bold">Bienvenido, <span id="username" class="text-white"></span></h2>
                            <p class="card-text mb-1"><strong>Rol:</strong> <span id="roles" class="badge bg-light text-dark"></span></p>
                            <div id="adminSection" style="display: none;">
                                <span class="badge bg-success mt-2"><i class="bi bi-shield-lock me-1"></i>Acceso de administrador</span>
                            </div>
                            <div id="noAccessSection" style="display: none;">
                                <span class="badge bg-warning mt-2"><i class="bi bi-exclamation-triangle me-1"></i>Acceso limitado</span>
                            </div>
                        </div>
                        <div class="col-md-4 text-center">
                            <i class="bi bi-speedometer2" style="font-size: 4rem; opacity: 0.8;"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Estadísticas Rápidas -->
    <div class="row">
        <!-- Usuarios -->
        <div class="col-md-6 col-lg-3 mb-4">
            <div class="card dashboard-card stat-card h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="text-muted mb-2">Usuarios</h6>
                            <h3 class="mb-0" th:text="${userCount}">0</h3>
                        </div>
                        <div class="bg-primary bg-opacity-10 p-3 rounded">
                            <i class="bi bi-people-fill text-primary" style="font-size: 1.5rem;"></i>
                        </div>
                    </div>
                    <a th:href="@{/admin/usuarios}" class="stretched-link"></a>
                </div>
            </div>
        </div>

        <!-- Gastos -->
        <div class="col-md-6 col-lg-3 mb-4">
            <div class="card dashboard-card stat-card h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="text-muted mb-2">Gastos</h6>
                            <h3 class="mb-0" th:text="${expenseCount}">0</h3>
                        </div>
                        <div class="bg-success bg-opacity-10 p-3 rounded">
                            <i class="bi bi-cash-stack text-success" style="font-size: 1.5rem;"></i>
                        </div>
                    </div>
                    <a th:href="@{/admin/expenses}" class="stretched-link"></a>
                </div>
            </div>
        </div>

        <!-- Tickets -->
        <div class="col-md-6 col-lg-3 mb-4">
            <div class="card dashboard-card stat-card h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="text-muted mb-2">Tickets</h6>
                            <h3 class="mb-0" th:text="${ticketCount}">0</h3>
                        </div>
                        <div class="bg-info bg-opacity-10 p-3 rounded">
                            <i class="bi bi-receipt text-info" style="font-size: 1.5rem;"></i>
                        </div>
                    </div>
                    <a th:href="@{/admin/tickets}" class="stretched-link"></a>
                </div>
            </div>
        </div>

        <!-- Contactos -->
        <div class="col-md-6 col-lg-3 mb-4">
            <div class="card dashboard-card stat-card h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="text-muted mb-2">Contactos</h6>
                            <h3 class="mb-0" th:text="${contactCount}">0</h3>
                        </div>
                        <div class="bg-warning bg-opacity-10 p-3 rounded">
                            <i class="bi bi-envelope text-warning" style="font-size: 1.5rem;"></i>
                        </div>
                    </div>
                    <a th:href="@{/admin/formcontacto}" class="stretched-link"></a>
                </div>
            </div>
        </div>
    </div>


    <!-- Información del Servidor -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card dashboard-card">
                <div class="card-header bg-white border-bottom-0">
                    <h5 class="mb-0 fw-bold"><i class="bi bi-hdd-network me-2"></i>Información del Servidor</h5>
                </div>
                <div class=" card-body justify-content px-4">
                    <div class="row  ">
                        <div class=" col-md-6 col-lg-7  ">
                            <p><strong>Nombre:</strong> <span th:text="${serverInfo.name}">N/A</span></p>
                            <p><strong>OS:</strong> <span th:text="${serverInfo.os}">N/A</span></p>
                            <p><strong>Tiempo activo:</strong> <span th:text="${serverInfo.uptimeSeconds}">0</span> segundos</p>
                        </div>
                        <div class="col-md-6 col-lg-5 ">
                            <p><strong>Carga CPU:</strong> <span th:text="${#numbers.formatDecimal(serverInfo.cpuLoad, 0, 2)}">0%</span>%</p>
                            <p><strong>Temperatura CPU:</strong> <span th:text="${serverInfo.cpuTemperature}">0</span> °C</p>
                            <p><strong>Memoria RAM usada:</strong>
                                <span th:text="${serverInfo.usedMemory / 1073741824 }">0</span> GB /
                                <span th:text="${serverInfo.totalMemory / 1073741824 }">0</span> GB
                            </p>
                            <p><strong>Disco usado:</strong>
                                <span th:text="${serverInfo.usedStorage}">0</span> GB /
                                <span th:text="${serverInfo.storage}">0</span> GB
                            </p>
                            <p><strong>OCR Python Activo:</strong>
                                <span th:text="${serverInfo.activeocr ? 'Sí' : 'No'}" class="badge" th:classappend="${serverInfo.activeocr ? 'bg-success' : 'bg-secondary'}"></span>
                            </p>
                            <p><strong>API Python Activa:</strong>
                                <span th:text="${serverInfo.activeapi ? 'Sí' : 'No'}" class="badge" th:classappend="${serverInfo.activeapi ? 'bg-success' : 'bg-secondary'}"></span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Sección de Actividad Reciente
    <div class="row mt-4">
        <div class="col-12">
            <div class="card dashboard-card">
                <div class="card-header bg-white border-bottom-0">
                    <h5 class="mb-0 fw-bold"><i class="bi bi-clock-history me-2"></i>Actividad Reciente</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                            <tr>
                                <th>Tipo</th>
                                <th>Descripción</th>
                                <th>Usuario</th>
                                <th>Fecha</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="log : ${recentActivity}">
                                <td><span th:text="${log.type}" class="badge" th:classappend="${log.type == 'LOGIN' ? 'bg-success' : 'bg-primary'}"></span></td>
                                <td th:text="${log.description}"></td>
                                <td th:text="${log.username}"></td>
                                <td th:text="${#temporals.format(log.timestamp, 'dd/MM/yyyy HH:mm')}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>-->















</div>

<!-- FOOTER -->
<footer class="py-4 bg-white text-dark mt-auto">
    <div class="container text-center">
        <p class="mb-0">Backend V1.0 Proyecto GESTHOR DAM Laureano</p>
    </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="/static/js/logout.js"></script>
<script src="/static/js/validadorDashboard.js"></script>
</body>
</html>