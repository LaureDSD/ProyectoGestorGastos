2025-05-20 19:36:31,588 - INFO - Texto extraído correctamente de imagen OCR.
2025-05-20 19:36:31,989 - ERROR - Error al procesar OCR imagen
Traceback (most recent call last):
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\OcrAiServer.py", line 226, in procesar_ocr_imagen_local
    response = openai.ChatCompletion.create(
        model=MODEL,
    ...<8 lines>...
        temperature=0.7,
    )
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_resources\chat_completion.py", line 25, in create
    return super().create(*args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_resources\abstract\engine_api_resource.py", line 153, in create
    response, _, api_key = requestor.request(
                           ~~~~~~~~~~~~~~~~~^
        "post",
        ^^^^^^^
    ...<5 lines>...
        request_timeout=request_timeout,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 298, in request
    resp, got_stream = self._interpret_response(result, stream)
                       ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 700, in _interpret_response
    self._interpret_response_line(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        result.content.decode("utf-8"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        stream=False,
        ^^^^^^^^^^^^^
    ),
    ^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
        rbody, rcode, resp.data, rheaders, stream_error=stream_error
    )
openai.error.AuthenticationError: Incorrect API key provided: NO-KEY. You can find your API key at https://platform.openai.com/account/api-keys.
2025-05-20 19:36:31,993 - ERROR - Error en /ocr
Traceback (most recent call last):
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\OcrAiServer.py", line 226, in procesar_ocr_imagen_local
    response = openai.ChatCompletion.create(
        model=MODEL,
    ...<8 lines>...
        temperature=0.7,
    )
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_resources\chat_completion.py", line 25, in create
    return super().create(*args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_resources\abstract\engine_api_resource.py", line 153, in create
    response, _, api_key = requestor.request(
                           ~~~~~~~~~~~~~~~~~^
        "post",
        ^^^^^^^
    ...<5 lines>...
        request_timeout=request_timeout,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 298, in request
    resp, got_stream = self._interpret_response(result, stream)
                       ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 700, in _interpret_response
    self._interpret_response_line(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        result.content.decode("utf-8"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        stream=False,
        ^^^^^^^^^^^^^
    ),
    ^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
        rbody, rcode, resp.data, rheaders, stream_error=stream_error
    )
openai.error.AuthenticationError: Incorrect API key provided: NO-KEY. You can find your API key at https://platform.openai.com/account/api-keys.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\OcrAiServer.py", line 426, in endpoint_ocr_image
    resultado = procesar_ocr_imagen_local(file)
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\OcrAiServer.py", line 248, in procesar_ocr_imagen_local
    raise RuntimeError(f"Error al procesar OCR imagen: {e}") from e
RuntimeError: Error al procesar OCR imagen: Incorrect API key provided: NO-KEY. You can find your API key at https://platform.openai.com/account/api-keys.
2025-05-20 19:36:58,828 - INFO - Texto extraído correctamente de imagen OCR.
2025-05-20 19:36:59,227 - ERROR - Error al procesar OCR imagen
Traceback (most recent call last):
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\OcrAiServer.py", line 226, in procesar_ocr_imagen_local
    response = openai.ChatCompletion.create(
        model=MODEL,
    ...<8 lines>...
        temperature=0.7,
    )
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_resources\chat_completion.py", line 25, in create
    return super().create(*args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_resources\abstract\engine_api_resource.py", line 153, in create
    response, _, api_key = requestor.request(
                           ~~~~~~~~~~~~~~~~~^
        "post",
        ^^^^^^^
    ...<5 lines>...
        request_timeout=request_timeout,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 298, in request
    resp, got_stream = self._interpret_response(result, stream)
                       ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 700, in _interpret_response
    self._interpret_response_line(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        result.content.decode("utf-8"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        stream=False,
        ^^^^^^^^^^^^^
    ),
    ^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
        rbody, rcode, resp.data, rheaders, stream_error=stream_error
    )
openai.error.AuthenticationError: Incorrect API key provided: NO-KEY. You can find your API key at https://platform.openai.com/account/api-keys.
2025-05-20 19:36:59,229 - ERROR - Error en /ocr
Traceback (most recent call last):
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\OcrAiServer.py", line 226, in procesar_ocr_imagen_local
    response = openai.ChatCompletion.create(
        model=MODEL,
    ...<8 lines>...
        temperature=0.7,
    )
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_resources\chat_completion.py", line 25, in create
    return super().create(*args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_resources\abstract\engine_api_resource.py", line 153, in create
    response, _, api_key = requestor.request(
                           ~~~~~~~~~~~~~~~~~^
        "post",
        ^^^^^^^
    ...<5 lines>...
        request_timeout=request_timeout,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 298, in request
    resp, got_stream = self._interpret_response(result, stream)
                       ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 700, in _interpret_response
    self._interpret_response_line(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        result.content.decode("utf-8"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        stream=False,
        ^^^^^^^^^^^^^
    ),
    ^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
        rbody, rcode, resp.data, rheaders, stream_error=stream_error
    )
openai.error.AuthenticationError: Incorrect API key provided: NO-KEY. You can find your API key at https://platform.openai.com/account/api-keys.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\OcrAiServer.py", line 426, in endpoint_ocr_image
    resultado = procesar_ocr_imagen_local(file)
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\OcrAiServer.py", line 248, in procesar_ocr_imagen_local
    raise RuntimeError(f"Error al procesar OCR imagen: {e}") from e
RuntimeError: Error al procesar OCR imagen: Incorrect API key provided: NO-KEY. You can find your API key at https://platform.openai.com/account/api-keys.
2025-05-20 19:44:15,516 - ERROR - Error en /aichat
Traceback (most recent call last):
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\OcrAiServer.py", line 364, in responder_chat
    response = openai.ChatCompletion.create(
        model="gpt-3.5-turbo",
    ...<5 lines>...
        max_tokens=500
    )
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_resources\chat_completion.py", line 25, in create
    return super().create(*args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_resources\abstract\engine_api_resource.py", line 153, in create
    response, _, api_key = requestor.request(
                           ~~~~~~~~~~~~~~~~~^
        "post",
        ^^^^^^^
    ...<5 lines>...
        request_timeout=request_timeout,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 298, in request
    resp, got_stream = self._interpret_response(result, stream)
                       ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 700, in _interpret_response
    self._interpret_response_line(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        result.content.decode("utf-8"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        stream=False,
        ^^^^^^^^^^^^^
    ),
    ^
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\venv\Lib\site-packages\openai\api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
        rbody, rcode, resp.data, rheaders, stream_error=stream_error
    )
openai.error.AuthenticationError: You didn't provide an API key. You need to provide your API key in an Authorization header using Bearer auth (i.e. Authorization: Bearer YOUR_KEY), or as the password field (with blank username) if you're accessing the API from your browser and are prompted for a username and password. You can obtain an API key from https://platform.openai.com/account/api-keys.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\OcrAiServer.py", line 493, in endpoint_Chat_Service
    resultado = responder_chat(mensaje)
  File "C:\Users\laure\Desktop\ProyectoGestorGastos\ServidorServicioOCR\ServidorPython\server\ApiRestOCR+AI\OcrAiServer.py", line 374, in responder_chat
    except (RateLimitError) as e:
            ^^^^^^^^^^^^^^
NameError: name 'RateLimitError' is not defined
